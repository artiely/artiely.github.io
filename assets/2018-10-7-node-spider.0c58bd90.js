import{i as a,o as p,c as t,j as n,k as e}from"./app.f1194776.js";const o=e(`<h1 id="%E7%BD%91%E7%BB%9C%E7%88%AC%E8%99%AB%E5%BC%80%E5%8F%91" tabindex="-1"><span class="prefix"></span><span class="content">\u7F51\u7EDC\u722C\u866B\u5F00\u53D1</span><span class="suffix"></span></h1><h2 id="%E4%BB%80%E4%B9%88%E6%98%AF%E7%88%AC%E8%99%AB" tabindex="-1"><span class="prefix"></span><span class="content">\u4EC0\u4E48\u662F\u722C\u866B</span><span class="suffix"></span></h2><p>\u53EF\u4EE5\u628A\u4E92\u8054\u7F51\u6BD4\u505A\u6210\u4E00\u5F20\u201C\u5927\u7F51\u201D\uFF0C\u722C\u866B\u5C31\u662F\u5728\u8FD9\u5F20\u5927\u7F51\u4E0A\u4E0D\u65AD\u722C\u53D6\u4FE1\u606F\u7684\u7A0B\u5E8F</p><p>\u6240\u4EE5\u4E00\u53E5\u8BDD\u603B\u7ED3\uFF1A<strong>\u722C\u866B\u662F\u8BF7\u6C42\u7F51\u7AD9\u5E76\u63D0\u53D6\u6570\u636E\u7684\u81EA\u52A8\u5316\u7A0B\u5E8F</strong></p><p>\u722C\u866B\u7684\u57FA\u672C\u5DE5\u4F5C\u6D41\u7A0B\u5982\u4E0B\uFF1A</p><ol><li>\u5411\u6307\u5B9A\u7684URL\u53D1\u9001http\u8BF7\u6C42</li><li>\u83B7\u53D6\u54CD\u5E94\uFF08HTML\u3001XML\u3001JSON\u3001\u4E8C\u8FDB\u5236\u7B49\u6570\u636E\uFF09</li><li>\u5904\u7406\u6570\u636E\uFF08\u89E3\u6790DOM\u3001\u89E3\u6790JSON\u7B49\uFF09</li><li>\u5C06\u5904\u7406\u597D\u7684\u6570\u636E\u8FDB\u884C\u5B58\u50A8</li></ol><figure><img src="https://gitee.com/artiely/Figure-bed/raw/master/images/20200314165104.jpg" alt="img"></figure><h2 id="%E7%88%AC%E8%99%AB%E7%9A%84%E6%84%8F%E4%B9%89" tabindex="-1"><span class="prefix"></span><span class="content">\u722C\u866B\u7684\u610F\u4E49</span><span class="suffix"></span></h2><p>\u722C\u866B\u5C31\u662F\u4E00\u4E2A\u63A2\u6D4B\u7A0B\u5E8F\uFF0C\u5B83\u7684\u57FA\u672C\u529F\u80FD\u5C31\u662F\u6A21\u62DF\u4EBA\u7684\u884C\u4E3A\u53BB\u5404\u4E2A\u7F51\u7AD9\u8F6C\u60A0\uFF0C\u70B9\u70B9\u6309\u94AE\uFF0C\u627E\u627E\u6570\u636E\uFF0C\u6216\u8005\u628A\u770B\u5230\u7684\u4FE1\u606F\u80CC\u56DE\u6765\u3002\u5C31\u50CF\u4E00\u53EA\u866B\u5B50\u5728\u4E00\u5E62\u697C\u91CC\u4E0D\u77E5\u75B2\u5026\u5730\u722C\u6765\u722C\u53BB\u3002</p><p>\u4F60\u53EF\u4EE5\u7B80\u5355\u5730\u60F3\u8C61\uFF1A<strong>\u6BCF\u4E2A\u722C\u866B\u90FD\u662F\u4F60\u7684\u201C\u5206\u8EAB\u201D\u3002\u5C31\u50CF\u5B59\u609F\u7A7A\u62D4\u4E86\u4E00\u64AE\u6C57\u6BDB\uFF0C\u5439\u51FA\u4E00\u5806\u7334\u5B50\u4E00\u6837\u3002</strong></p><p>\u4F60\u6BCF\u5929\u4F7F\u7528\u7684\u767E\u5EA6\u548CGoogle\uFF0C\u5176\u5B9E\u5C31\u662F\u5229\u7528\u4E86\u8FD9\u79CD\u722C\u866B\u6280\u672F\uFF1A\u6BCF\u5929\u653E\u51FA\u65E0\u6570\u722C\u866B\u5230\u5404\u4E2A\u7F51\u7AD9\uFF0C\u628A\u4ED6\u4EEC\u7684\u4FE1\u606F\u6293\u56DE\u6765\uFF0C\u5B58\u5230\u6570\u636E\u5E93\u4E2D\u7B49\u4F60\u6765\u68C0\u7D22\u3002</p><p><img src="https://gitee.com/artiely/Figure-bed/raw/master/images/20200314165105.jpg" alt="img">\u62A2\u7968\u8F6F\u4EF6\uFF0C\u5C31\u76F8\u5F53\u4E8E\u6492\u51FA\u53BB\u65E0\u6570\u4E2A\u5206\u8EAB\uFF0C\u6BCF\u4E00\u4E2A\u5206\u8EAB\u90FD\u5E2E\u52A9\u4F60\u4E0D\u65AD\u5237\u65B0 12306 \u7F51\u7AD9\u7684\u706B\u8F66\u4F59\u7968\u3002\u4E00\u65E6\u53D1\u73B0\u6709\u7968\uFF0C\u5C31\u9A6C\u4E0A\u4E0B\u5355\uFF0C\u7136\u540E\u5BF9\u4F60\u558A\uFF1A\u5927\u7237\u5FEB\u6765\u4ED8\u6B3E\u5440\u3002</p><p>\u5728\u73B0\u5B9E\u4E2D\u51E0\u4E4E\u6240\u6709\u884C\u4E1A\u7684\u7F51\u7AD9\u90FD\u4F1A\u88AB\u722C\u866B\u6240 \u201C\u9A9A\u6270\u201D\uFF0C\u800C\u8FD9\u4E9B\u9A9A\u6270\u90FD\u662F\u4E3A\u4E86\u65B9\u4FBF\u7528\u6237</p><figure><img src="https://gitee.com/artiely/Figure-bed/raw/master/images/20200314165106.png" alt="1562640698673"></figure><p>\u5F53\u7136\uFF0C\u6709\u4E9B\u7F51\u7AD9\u662F\u4E0D\u80FD\u88AB\u8FC7\u5206\u9A9A\u6270\u7684\uFF0C\u5176\u4E2D\u6392\u7B2C\u4E00\u7684\u5C31\u662F\u51FA\u884C\u7C7B\u884C\u4E1A\u3002</p><p>12306\u4E4B\u6240\u4EE5\u4F1A\u51FA\u5982\u6B64\u53D8\u6001\u7684\u9A8C\u8BC1\u7801\uFF0C\u5C31\u662F\u56E0\u4E3A\u88AB\u722C\u866B\u6298\u78E8\u7684\u65E0\u53EF\u5948\u4F55</p><figure><img src="https://gitee.com/artiely/Figure-bed/raw/master/images/20200314165107.jpg" alt="img"></figure><figure><img src="https://gitee.com/artiely/Figure-bed/raw/master/images/20200314165108.jpg" alt="img"></figure><p>\u6B63\u6240\u8C13\u9053\u9AD8\u4E00\u5C3A\u9B54\u9AD8\u4E00\u4E08\uFF0C\u67D0\u4E9B\u722C\u866B\u5DE5\u5177\uFF0C\u4E3A\u4E86\u89E3\u51B3\u8FD9\u79CD\u53D8\u6001\u9A8C\u8BC1\u7801\uFF0C\u751A\u81F3\u63A8\u51FA\u4E86\u201C\u6253\u7801\u5E73\u53F0\u201D</p><p>\u539F\u7406\u5C31\u662F\u722C\u866B\u8FD8\u662F\u4E0D\u65AD\u5DE5\u4F5C\uFF0C\u4F46\u53EA\u8981\u9047\u5230\u4E8C\u7EF4\u7801\uFF0C\u5C31\u901A\u8FC7\u6253\u7801\u5E73\u53F0\u4E0B\u53D1\u4EFB\u52A1\uFF0C\u6253\u7801\u5E73\u53F0\u53E6\u4E00\u8FB9\u5C31\u96C7\u4F63\u4E00\u5927\u5806\u7F51\u7EDC\u95F2\u4EBA\uFF0C\u53EA\u8981\u770B\u5230\u6709\u9A8C\u8BC1\u7801\u6765\u4E86\uFF0C\u5C31\u4EBA\u5DE5\u9009\u4E00\u4E0B\u9A8C\u8BC1\u7801\uFF0C\u5B8C\u7F8E\u7684\u8BA9\u7A0B\u5E8F\u4E0E\u4EBA\u5DE5\u7ED3\u5408\uFF01</p><h2 id="%E5%86%85%E5%AE%B9%E5%8F%8A%E7%9B%AE%E6%A0%87" tabindex="-1"><span class="prefix"></span><span class="content">\u5185\u5BB9\u53CA\u76EE\u6807</span><span class="suffix"></span></h2><ol><li>\u722C\u866B\u7B80\u4ECB</li><li>\u5236\u4F5C\u4E00\u4E2A\u81EA\u52A8\u4E0B\u8F7D\u56FE\u7247\u7684\u5C0F\u722C\u866B</li><li>\u4F7F\u7528Selenium\u722C\u53D6\u52A8\u6001\u7F51\u7AD9</li></ol><h2 id="%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86" tabindex="-1"><span class="prefix"></span><span class="content">\u524D\u7F6E\u77E5\u8BC6</span><span class="suffix"></span></h2><ol><li>js\u57FA\u7840</li><li>node\u57FA\u7840</li></ol><h1 id="%E7%88%AC%E8%99%AB%E5%9F%BA%E7%A1%80" tabindex="-1"><span class="prefix"></span><span class="content">\u722C\u866B\u57FA\u7840</span><span class="suffix"></span></h1><p>\u5B66\u4E60\u76EE\u6807:</p><ul><li>\u4EE5<code class="">http://www.meizitu.com</code>\u7F51\u7AD9\u76EE\u6807\u4E3A\u4F8B\uFF0C\u6700\u7EC8\u76EE\u7684\u662F\u4E0B\u8F7D\u7F51\u7AD9\u4E2D\u6240\u6709\u59B9\u5B50\u7684\u7167\u7247\uFF1A</li></ul><figure><img src="https://gitee.com/artiely/Figure-bed/raw/master/images/20200314163724.png" alt=""></figure><p>\u4E0B\u8F7D\u6240\u6709\u59B9\u5B50\u7684\u7167\u7247\uFF0C\u9700\u8981\u901A\u8FC7\u5982\u4E0B\u6B65\u9AA4\u5B9E\u73B0\uFF1A</p><ol><li>\u53D1\u9001http\u8BF7\u6C42\uFF0C\u83B7\u53D6\u6574\u4E2A\u7F51\u9875\u5185\u5BB9</li><li>\u901A\u8FC7cheerio\u5E93\u5BF9\u7F51\u9875\u5185\u5BB9\u8FDB\u884C\u5206\u6790</li><li>\u63D0\u53D6img\u6807\u7B7E\u7684src\u5C5E\u6027</li><li>\u4F7F\u7528download\u5E93\u8FDB\u884C\u6279\u91CF\u56FE\u7247\u4E0B\u8F7D</li></ol><h2 id="%E5%8F%91%E9%80%81%E4%B8%80%E4%B8%AAhttp%E8%AF%B7%E6%B1%82" tabindex="-1"><span class="prefix"></span><span class="content">\u53D1\u9001\u4E00\u4E2AHTTP\u8BF7\u6C42</span><span class="suffix"></span></h2><p>\u5B66\u4E60\u76EE\u6807\uFF1A</p><ul><li>\u53D1\u9001HTTP\u8BF7\u6C42\u5E76\u83B7\u53D6\u76F8\u5E94</li></ul><p>\u5728\u5B66\u4E60\u722C\u866B\u4E4B\u524D\uFF0C\u9700\u8981\u5BF9HTTP\u8BF7\u6C42\u5145\u5206\u4E86\u89E3\uFF0C\u56E0\u4E3A\u722C\u866B\u7684\u539F\u7406\u5C31\u662F\u53D1\u9001\u8BF7\u6C42\u5230\u6307\u5B9AURL\uFF0C\u83B7\u53D6\u54CD\u5E94\u540E\u5E76\u5904\u7406</p><h3 id="node%E5%AE%98%E6%96%B9api" tabindex="-1"><span class="prefix"></span><span class="content">node\u5B98\u65B9api</span><span class="suffix"></span></h3><p>node\u7684\u6838\u5FC3\u6A21\u5757 http\u6A21\u5757\u5373\u53EF\u53D1\u9001\u8BF7\u6C42\uFF0C\u6458\u81EAnode\u5B98\u7F51api\uFF1A</p><figure><img src="https://gitee.com/artiely/Figure-bed/raw/master/images/20200314165109.png" alt="1562842951982"></figure><p>\u7531\u6B64\u53EF\u89C1\u53EA\u9700\u8981\u4F7F\u7528<code class="">http.request()</code>\u65B9\u6CD5\u5373\u53EF\u53D1\u9001http\u8BF7\u6C42</p><h3 id="%E5%8F%91%E9%80%81http%E8%AF%B7%E6%B1%82%E6%A1%88%E4%BE%8B" tabindex="-1"><span class="prefix"></span><span class="content">\u53D1\u9001http\u8BF7\u6C42\u6848\u4F8B</span><span class="suffix"></span></h3><p>\u4E5F\u53EF\u4EE5\u4F7F\u7528<code class="">axios</code>\u5E93\u6765\u4EE3\u66FF</p><p>\u4EE3\u7801\u5982\u4E0B\uFF1A</p><div class="language-js ext-js code-wrapper"><div class="cbt-traffic_light"><span></span><span></span><span></span></div><span class="copy"></span><div class="code-inner"><pre class="language-js line-numbers-mode"><code class="language-js"><span class="token comment">// \u5F15\u5165http\u6A21\u5757</span>
<span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;http&#39;</span><span class="token punctuation">)</span>
<span class="token comment">// \u521B\u5EFA\u8BF7\u6C42\u5BF9\u8C61</span>
<span class="token keyword">const</span> req <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token string">&#39;https://www.meizitu.com/a/5521.html&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// \u51C6\u5907chunks</span>
  <span class="token keyword">const</span> chunks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  res<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;data&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">chunk</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u76D1\u542C\u5230\u6570\u636E\u5C31\u5B58\u50A8</span>
    chunks<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>chunk<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  res<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;end&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u7ED3\u675F\u6570\u636E\u76D1\u542C\u65F6\u8BB2\u6240\u6709\u5185\u5BB9\u62FC\u63A5</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Buffer<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>chunks<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">&#39;utf-8&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// \u53D1\u9001\u8BF7\u6C42</span>
req<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>\u5F97\u5230\u7684\u7ED3\u679C\u5C31\u662F\u6574\u4E2AHTML\u7F51\u9875\u5185\u5BB9</p><h2 id="%E5%B0%86%E8%8E%B7%E5%8F%96%E7%9A%84html%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%BD%BF%E7%94%A8cheerio%E8%A7%A3%E6%9E%90" tabindex="-1"><span class="prefix"></span><span class="content">\u5C06\u83B7\u53D6\u7684HTML\u5B57\u7B26\u4E32\u4F7F\u7528cheerio\u89E3\u6790</span><span class="suffix"></span></h2><p>\u76EE\u6807\uFF1A</p><ul><li>\u4F7F\u7528cheerio\u52A0\u8F7DHTML</li><li>\u56DE\u987EjQueryAPI</li><li>\u52A0\u8F7D\u6240\u6709\u7684img\u6807\u7B7E\u7684src\u5C5E\u6027</li></ul><h3 id="cheerio%E5%BA%93%E7%AE%80%E4%BB%8B" tabindex="-1"><span class="prefix"></span><span class="content">cheerio\u5E93\u7B80\u4ECB</span><span class="suffix"></span></h3><figure><img src="https://gitee.com/artiely/Figure-bed/raw/master/images/20200314165110.png" alt="1562843968162"></figure><blockquote><p>\u8FD9\u662F\u4E00\u4E2A\u6838\u5FC3api\u6309\u7167jquery\u6765\u8BBE\u8BA1\uFF0C\u4E13\u95E8\u5728\u670D\u52A1\u5668\u4E0A\u4F7F\u7528\uFF0C\u4E00\u4E2A\u5FAE\u5C0F\u3001\u5FEB\u901F\u548C\u4F18\u96C5\u7684\u5B9E\u73B0</p></blockquote><p>\u7B80\u800C\u8A00\u4E4B\uFF0C\u5C31\u662F\u53EF\u4EE5\u518D\u670D\u52A1\u5668\u4E0A\u7528\u8FD9\u4E2A\u5E93\u6765\u89E3\u6790HTML\u4EE3\u7801\uFF0C\u5E76\u4E14\u53EF\u4EE5\u76F4\u63A5\u4F7F\u7528\u548CjQuery\u4E00\u6837\u7684api</p><p>\u5B98\u65B9demo\u5982\u4E0B\uFF1A</p><div class="language-js ext-js code-wrapper"><div class="cbt-traffic_light"><span></span><span></span><span></span></div><span class="copy"></span><div class="code-inner"><pre class="language-js line-numbers-mode"><code class="language-js"><span class="token keyword">const</span> cheerio <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;cheerio&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> $ <span class="token operator">=</span> cheerio<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token string">&#39;&lt;h2 class=&quot;title&quot;&gt;Hello world&lt;/h2&gt;&#39;</span><span class="token punctuation">)</span>

<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;h2.title&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">&#39;Hello there!&#39;</span><span class="token punctuation">)</span>
<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;h2&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addClass</span><span class="token punctuation">(</span><span class="token string">&#39;welcome&#39;</span><span class="token punctuation">)</span>

$<span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// =&gt; &lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;h2 class=&quot;title welcome&quot;&gt;Hello there!&lt;/h2&gt;&lt;/body&gt;&lt;/html&gt;</span>
</code></pre></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>\u540C\u6837\u4E5F\u53EF\u4EE5\u901A\u8FC7jQuery\u7684api\u6765\u83B7\u53D6DOM\u5143\u7D20\u4E2D\u7684\u5C5E\u6027\u548C\u5185\u5BB9</p><h3 id="%E4%BD%BF%E7%94%A8cheerio%E5%BA%93%E8%A7%A3%E6%9E%90html" tabindex="-1"><span class="prefix"></span><span class="content">\u4F7F\u7528cheerio\u5E93\u89E3\u6790HTML</span><span class="suffix"></span></h3><ol><li>\u5206\u6790\u7F51\u9875\u4E2D\u6240\u6709img\u6807\u7B7E\u6240\u5728\u7ED3\u6784</li></ol><figure><img src="https://gitee.com/artiely/Figure-bed/raw/master/images/20200314163928.png" alt=""></figure><ol start="2"><li>\u4F7F\u7528jQuery API\u83B7\u53D6\u6240\u6709img\u7684src\u5C5E\u6027</li></ol><div class="language-js ext-js code-wrapper"><div class="cbt-traffic_light"><span></span><span></span><span></span></div><span class="copy"></span><div class="code-inner"><pre class="language-js line-numbers-mode"><code class="language-js"><span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;http&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> cheerio <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;cheerio&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> req <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token string">&#39;https://www.meizitu.com/a/5521.html&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> chunks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  res<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;data&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">chunk</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    chunks<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>chunk<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  res<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;end&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// console.log(Buffer.concat(chunks).toString(&#39;utf-8&#39;))</span>
    <span class="token keyword">const</span> html <span class="token operator">=</span> Buffer<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>chunks<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">&#39;utf-8&#39;</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> $ <span class="token operator">=</span> cheerio<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span>
    <span class="token keyword">const</span> imgArr <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;#picture &gt; img&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token function">$</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&#39;src&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>imgArr<span class="token punctuation">)</span>

  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

req<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h2 id="%E4%BD%BF%E7%94%A8download%E5%BA%93%E6%89%B9%E9%87%8F%E4%B8%8B%E8%BD%BD%E5%9B%BE%E7%89%87" tabindex="-1"><span class="prefix"></span><span class="content">\u4F7F\u7528download\u5E93\u6279\u91CF\u4E0B\u8F7D\u56FE\u7247</span><span class="suffix"></span></h2><div class="language-js ext-js code-wrapper"><div class="cbt-traffic_light"><span></span><span></span><span></span></div><span class="copy"></span><div class="code-inner"><pre class="language-js line-numbers-mode"><code class="language-js"><span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;http&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> cheerio <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;cheerio&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> download <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;download&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> req <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token string">&#39;http://xxx&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> chunks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  res<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;data&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">chunk</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    chunks<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>chunk<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  res<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;end&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// console.log(Buffer.concat(chunks).toString(&#39;utf-8&#39;))</span>
    <span class="token keyword">const</span> html <span class="token operator">=</span> Buffer<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>chunks<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">&#39;utf-8&#39;</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> $ <span class="token operator">=</span> cheerio<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span>
    <span class="token keyword">const</span> imgArr <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;xx &gt; img&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token function">encodeURI</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&#39;src&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment">// console.log(imgArr)</span>

    Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span>imgArr<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">x</span> <span class="token operator">=&gt;</span> <span class="token function">download</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token string">&#39;dist&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;files downloaded!&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

req<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>\u6CE8\u610F\u4E8B\u9879\uFF1A\u5982\u6709\u4E2D\u6587\u6587\u4EF6\u540D\uFF0C\u9700\u8981\u4F7F\u7528base64\u7F16\u7801</p><h2 id="%E7%88%AC%E5%8F%96%E6%96%B0%E9%97%BB%E4%BF%A1%E6%81%AF" tabindex="-1"><span class="prefix"></span><span class="content">\u722C\u53D6\u65B0\u95FB\u4FE1\u606F</span><span class="suffix"></span></h2><p>\u5927\u90E8\u5206\u65B0\u95FB\u7F51\u7AD9\uFF0C\u73B0\u5728\u90FD\u91C7\u53D6\u524D\u540E\u7AEF\u5206\u79BB\u7684\u65B9\u5F0F\uFF0C\u4E5F\u5C31\u662F\u524D\u7AEF\u9875\u9762\u5148\u5199\u597D\u6A21\u677F\uFF0C\u7B49\u7F51\u9875\u52A0\u8F7D\u5B8C\u6BD5\u540E\uFF0C\u53D1\u9001Ajax\u518D\u83B7\u53D6\u6570\u636E\uFF0C\u5C06\u5176\u6E32\u67D3\u5230\u6A21\u677F\u4E2D\u3002\u6240\u4EE5\u5982\u679C\u4F7F\u7528\u76F8\u540C\u65B9\u5F0F\u6765\u83B7\u53D6\u76EE\u6807\u7F51\u7AD9\u7684HTML\u9875\u9762\uFF0C\u8BF7\u6C42\u5230\u7684\u53EA\u662F\u6A21\u677F\uFF0C\u5E76\u4E0D\u4F1A\u6709\u6570\u636E\uFF1A</p><figure><img src="https://gitee.com/artiely/Figure-bed/raw/master/images/20200314165111.png" alt="1563271689010"></figure><p>\u6B64\u65F6\uFF0C\u5982\u679C\u8FD8\u5E0C\u671B\u4F7F\u7528\u5F53\u524D\u65B9\u6CD5\u722C\u53D6\u6570\u636E\uFF0C\u5C31\u9700\u8981\u5206\u6790\u8BE5\u7F51\u7AD9\u7684ajax\u8BF7\u6C42\u662F\u5982\u4F55\u53D1\u9001\u7684\uFF0C\u53EF\u4EE5\u6253\u5F00network\u9762\u677F\u6765\u8C03\u8BD5\uFF1A</p><p>\u5206\u6790\u5F97\u51FA\u5BF9\u5E94\u7684ajax\u8BF7\u6C42\u540E\uFF0C\u627E\u5230\u5176URL\uFF0C\u5411\u5176\u53D1\u9001\u8BF7\u6C42\u5373\u53EF</p><p>\u4EE3\u7801\u5982\u4E0B\uFF1A</p><div class="language-js ext-js code-wrapper"><div class="cbt-traffic_light"><span></span><span></span><span></span></div><span class="copy"></span><div class="code-inner"><pre class="language-js line-numbers-mode"><code class="language-js"><span class="token comment">// \u5F15\u5165http\u6A21\u5757</span>
<span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;http&#39;</span><span class="token punctuation">)</span>

<span class="token comment">// \u521B\u5EFA\u8BF7\u6C42\u5BF9\u8C61 (\u6B64\u65F6\u672A\u53D1\u9001http\u8BF7\u6C42)</span>
<span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token string">&#39;http://xxx&#39;</span>
<span class="token keyword">const</span> req <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// \u5F02\u6B65\u7684\u54CD\u5E94</span>
  <span class="token comment">// console.log(res)</span>
  <span class="token keyword">const</span> chunks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token comment">// \u76D1\u542Cdata\u4E8B\u4EF6,\u83B7\u53D6\u4F20\u9012\u8FC7\u6765\u7684\u6570\u636E\u7247\u6BB5</span>
  <span class="token comment">// \u62FC\u63A5\u6570\u636E\u7247\u6BB5</span>
  res<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;data&#39;</span><span class="token punctuation">,</span> <span class="token parameter">c</span> <span class="token operator">=&gt;</span> chunks<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span>

  <span class="token comment">// \u76D1\u542Cend\u4E8B\u4EF6,\u83B7\u53D6\u6570\u636E\u5B8C\u6BD5\u65F6\u89E6\u53D1</span>
  res<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;end&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u62FC\u63A5\u6240\u6709\u7684chunk,\u5E76\u8F6C\u6362\u6210\u5B57\u7B26\u4E32 ==&gt; html\u5B57\u7B26\u4E32</span>
    <span class="token comment">// console.log(Buffer.concat(chunks).toString(&#39;utf-8&#39;))</span>
    <span class="token keyword">const</span> result <span class="token operator">=</span> Buffer<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>chunks<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">&#39;utf-8&#39;</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// \u5C06\u8BF7\u6C42\u53D1\u51FA\u53BB</span>
req<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>\u5982\u679C\u9047\u5230\u8BF7\u6C42\u9650\u5236\uFF0C\u8FD8\u53EF\u4EE5\u6A21\u62DF\u771F\u5B9E\u6D4F\u89C8\u5668\u7684\u8BF7\u6C42\u5934\uFF1A</p><div class="language-js ext-js code-wrapper"><div class="cbt-traffic_light"><span></span><span></span><span></span></div><span class="copy"></span><div class="code-inner"><pre class="language-js line-numbers-mode"><code class="language-js"><span class="token comment">// \u5F15\u5165http\u6A21\u5757</span>
<span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;http&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> cheerio <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;cheerio&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> download <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;download&#39;</span><span class="token punctuation">)</span>

<span class="token comment">// \u521B\u5EFA\u8BF7\u6C42\u5BF9\u8C61 (\u6B64\u65F6\u672A\u53D1\u9001http\u8BF7\u6C42)</span>
<span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token string">&#39;http://www.xx&#39;</span>
<span class="token keyword">const</span> req <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&#39;Host&#39;</span><span class="token operator">:</span> <span class="token string">&#39;www.xx.cn&#39;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&#39;Connection&#39;</span><span class="token operator">:</span> <span class="token string">&#39;keep-alive&#39;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&#39;Content-Length&#39;</span><span class="token operator">:</span> <span class="token string">&#39;0&#39;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&#39;Accept&#39;</span><span class="token operator">:</span> <span class="token string">&#39;*/*&#39;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&#39;Origin&#39;</span><span class="token operator">:</span> <span class="token string">&#39;http://www.xx.cn&#39;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&#39;X-Requested-With&#39;</span><span class="token operator">:</span> <span class="token string">&#39;XMLHttpRequest&#39;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&#39;User-Agent&#39;</span><span class="token operator">:</span> <span class="token string">&#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.100 Safari/537.36&#39;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&#39;DNT&#39;</span><span class="token operator">:</span> <span class="token string">&#39;1&#39;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&#39;Referer&#39;</span><span class="token operator">:</span> <span class="token string">&#39;http://www.xx.cn/newsvideo/newslist.html&#39;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&#39;Accept-Encoding&#39;</span><span class="token operator">:</span> <span class="token string">&#39;gzip, deflate&#39;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&#39;Accept-Language&#39;</span><span class="token operator">:</span> <span class="token string">&#39;zh-CN,zh;q=0.9,en;q=0.8&#39;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&#39;Cookie&#39;</span><span class="token operator">:</span> <span class="token string">&#39;UM_distinctid=16b8a0c1ea534c-0c311b256ffee7-e343166-240000-16b8a0c1ea689c; bad_idb2f10070-624e-11e8-917f-9fb8db4dc43c=8e1dcca1-9692-11e9-97fb-e5908bcaecf8; parent_qimo_sid_b2f10070-624e-11e8-917f-9fb8db4dc43c=921b3900-9692-11e9-9a47-855e632e21e7; CNZZDATA1277769855=1043056636-1562825067-null%7C1562825067; cid_litiancheng_xx.cn=TUd3emFUWjBNV2syWVRCdU5XTTRhREZs; PHPSESSID=j3ppafq1dgh2jfg6roc8eeljg2; CNZZDATA4617777=cnzz_eid%3D926291424-1561388898-http%253A%252F%252Fmail.x.cn%252F%26ntime%3D1563262791; Hm_lvt_0cb375a2e834821b74efffa6c71ee607=1561389179,1563266246; qimo_seosource_22bdcd10-6250-11e8-917f-9fb8db4dc43c=%E7%AB%99%E5%86%85; qimo_seokeywords_22bdcd10-6250-11e8-917f-9fb8db4dc43c=; href=http%3A%2F%2Fwww.xx.cn%2F; bad_id22bdcd10-6250-11e8-917f-9fb8db4dc43c=f2f41b71-a7a4-11e9-93cc-9b702389a8cb; nice_id22bdcd10-6250-11e8-917f-9fb8db4dc43c=f2f41b72-a7a4-11e9-93cc-9b702389a8cb; openChat22bdcd10-6250-11e8-917f-9fb8db4dc43c=true; parent_qimo_sid_22bdcd10-6250-11e8-917f-9fb8db4dc43c=fc61e520-a7a4-11e9-94a8-01dabdc2ed41; qimo_seosource_b2f10070-624e-11e8-917f-9fb8db4dc43c=%E7%AB%99%E5%86%85; qimo_seokeywords_b2f10070-624e-11e8-917f-9fb8db4dc43c=; accessId=b2f10070-624e-11e8-917f-9fb8db4dc43c; pageViewNum=2; nice_idb2f10070-624e-11e8-917f-9fb8db4dc43c=20d2a1d1-a7a8-11e9-bc20-e71d1b8e4bb6; openChatb2f10070-624e-11e8-917f-9fb8db4dc43c=true; Hm_lpvt_0cb375a2e834821b74efffa6c71ee607=1563267937&#39;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// \u5F02\u6B65\u7684\u54CD\u5E94</span>
  <span class="token comment">// console.log(res)</span>
  <span class="token keyword">const</span> chunks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token comment">// \u76D1\u542Cdata\u4E8B\u4EF6,\u83B7\u53D6\u4F20\u9012\u8FC7\u6765\u7684\u6570\u636E\u7247\u6BB5</span>
  <span class="token comment">// \u62FC\u63A5\u6570\u636E\u7247\u6BB5</span>
  res<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;data&#39;</span><span class="token punctuation">,</span> <span class="token parameter">c</span> <span class="token operator">=&gt;</span> chunks<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span>

  <span class="token comment">// \u76D1\u542Cend\u4E8B\u4EF6,\u83B7\u53D6\u6570\u636E\u5B8C\u6BD5\u65F6\u89E6\u53D1</span>
  res<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;end&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u62FC\u63A5\u6240\u6709\u7684chunk,\u5E76\u8F6C\u6362\u6210\u5B57\u7B26\u4E32 ==&gt; html\u5B57\u7B26\u4E32</span>
    <span class="token comment">// console.log(Buffer.concat(chunks).toString(&#39;utf-8&#39;))</span>
    <span class="token keyword">const</span> result <span class="token operator">=</span> Buffer<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>chunks<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">&#39;utf-8&#39;</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// \u5C06\u8BF7\u6C42\u53D1\u51FA\u53BB</span>
req<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><p>\u6CE8\u610F\uFF1A\u8BF7\u6C42\u5934\u7684\u5185\u5BB9\uFF0C\u53EF\u4EE5\u5148\u901A\u8FC7\u771F\u6B63\u7684\u6D4F\u89C8\u5668\u8BBF\u95EE\u4E00\u6B21\u540E\u83B7\u53D6</p><h2 id="%E5%B0%81%E8%A3%85%E7%88%AC%E8%99%AB%E5%9F%BA%E7%A1%80%E5%BA%93" tabindex="-1"><span class="prefix"></span><span class="content">\u5C01\u88C5\u722C\u866B\u57FA\u7840\u5E93</span><span class="suffix"></span></h2><p>\u4EE5\u4E0A\u4EE3\u7801\u91CD\u590D\u7684\u5730\u65B9\u975E\u5E38\u591A\uFF0C\u53EF\u4EE5\u8003\u8651\u4EE5\u9762\u5411\u5BF9\u8C61\u7684\u601D\u60F3\u8FDB\u884C\u5C01\u88C5\uFF0C\u8FDB\u4E00\u6B65\u7684\u63D0\u9AD8\u4EE3\u7801\u590D\u7528\u7387\uFF0C\u4E3A\u4E86\u65B9\u4FBF\u5F00\u53D1\uFF0C\u4FDD\u8BC1\u4EE3\u7801\u89C4\u8303\uFF0C\u5EFA\u8BAE\u4F7F\u7528TypeScript\u8FDB\u884C\u5C01\u88C5</p><p><strong>\u4EE5\u4E0B\u77E5\u8BC6\u70B9\u4E3A\u6269\u5C55\u5185\u5BB9\uFF0C\u9700\u8981\u5BF9\u9762\u5411\u5BF9\u8C61\u548CTypeScript\u6709\u4E00\u5B9A\u4E86\u89E3\uFF01</strong></p><p>\u6267\u884C<code class="">tsc --init</code>\u521D\u59CB\u5316\u9879\u76EE\uFF0C\u751F\u6210ts\u914D\u7F6E\u6587\u4EF6</p><p>TS\u914D\u7F6E\uFF1A</p><div class="language-json ext-json code-wrapper"><div class="cbt-traffic_light"><span></span><span></span><span></span></div><span class="copy"></span><div class="code-inner"><pre class="language-json line-numbers-mode"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">&quot;compilerOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">/* Basic Options */</span>
    <span class="token property">&quot;target&quot;</span><span class="token operator">:</span> <span class="token string">&quot;es2015&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;module&quot;</span><span class="token operator">:</span> <span class="token string">&quot;commonjs&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;outDir&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./bin&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;rootDir&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./src&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;strict&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">&quot;esModuleInterop&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;include&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;src/**/*&quot;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;exclude&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;node_modules&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;**/*.spec.ts&quot;</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>Spider\u62BD\u8C61\u7C7B\uFF1A</p><div class="language-ts ext-ts code-wrapper"><div class="cbt-traffic_light"><span></span><span></span><span></span></div><span class="copy"></span><div class="code-inner"><pre class="language-ts line-numbers-mode"><code class="language-ts"><span class="token comment">// \u5F15\u5165http\u6A21\u5757</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token class-name">SpiderOptions</span> <span class="token keyword">from</span> <span class="token string">&#39;./interfaces/SpiderOptions&#39;</span>
<span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">&#39;http&#39;</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Spider</span> <span class="token punctuation">{</span>
  options<span class="token operator">:</span> SpiderOptions
  <span class="token function">constructor</span><span class="token punctuation">(</span>options<span class="token operator">:</span> SpiderOptions <span class="token operator">=</span> <span class="token punctuation">{</span> url<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span> method<span class="token operator">:</span> <span class="token string">&#39;get&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>options <span class="token operator">=</span> options
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u521B\u5EFA\u8BF7\u6C42\u5BF9\u8C61 (\u6B64\u65F6\u672A\u53D1\u9001http\u8BF7\u6C42)</span>
    <span class="token keyword">const</span> req <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>url<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      headers<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>headers<span class="token punctuation">,</span>
      method<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>method<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>res<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// \u5F02\u6B65\u7684\u54CD\u5E94</span>
      <span class="token comment">// console.log(res)</span>
      <span class="token keyword">const</span> chunks<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
      <span class="token comment">// \u76D1\u542Cdata\u4E8B\u4EF6,\u83B7\u53D6\u4F20\u9012\u8FC7\u6765\u7684\u6570\u636E\u7247\u6BB5</span>
      <span class="token comment">// \u62FC\u63A5\u6570\u636E\u7247\u6BB5</span>
      res<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;data&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>c<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> chunks<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span>

      <span class="token comment">// \u76D1\u542Cend\u4E8B\u4EF6,\u83B7\u53D6\u6570\u636E\u5B8C\u6BD5\u65F6\u89E6\u53D1</span>
      res<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;end&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// \u62FC\u63A5\u6240\u6709\u7684chunk,\u5E76\u8F6C\u6362\u6210\u5B57\u7B26\u4E32 ==&gt; html\u5B57\u7B26\u4E32</span>
        <span class="token keyword">const</span> htmlStr <span class="token operator">=</span> Buffer<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>chunks<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">&#39;utf-8&#39;</span><span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">onCatchHTML</span><span class="token punctuation">(</span>htmlStr<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token comment">// \u5C06\u8BF7\u6C42\u53D1\u51FA\u53BB</span>
    req<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token punctuation">}</span>

  <span class="token keyword">abstract</span> <span class="token function">onCatchHTML</span><span class="token punctuation">(</span>result<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">any</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Spider
</code></pre></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><p>SpiderOptions\u63A5\u53E3\uFF1A</p><div class="language-ts ext-ts code-wrapper"><div class="cbt-traffic_light"><span></span><span></span><span></span></div><span class="copy"></span><div class="code-inner"><pre class="language-ts line-numbers-mode"><code class="language-ts"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">interface</span> <span class="token class-name">SpiderOptions</span> <span class="token punctuation">{</span>
  url<span class="token operator">:</span> <span class="token builtin">string</span>
  method<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span>
  headers<span class="token operator">?</span><span class="token operator">:</span> object
<span class="token punctuation">}</span>
</code></pre></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>PhotoListSpider\u7C7B\uFF1A</p><div class="language-ts ext-ts code-wrapper"><div class="cbt-traffic_light"><span></span><span></span><span></span></div><span class="copy"></span><div class="code-inner"><pre class="language-ts line-numbers-mode"><code class="language-ts"><span class="token keyword">import</span> Spider <span class="token keyword">from</span> <span class="token string">&#39;./Spider&#39;</span>
<span class="token keyword">const</span> cheerio <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">&#39;cheerio&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> download <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">&#39;download&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">PhotoListSpider</span> <span class="token keyword">extends</span> <span class="token class-name">Spider</span> <span class="token punctuation">{</span>
  <span class="token function">onCatchHTML</span><span class="token punctuation">(</span>result<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// console.log(result)</span>
    <span class="token keyword">const</span> $ <span class="token operator">=</span> cheerio<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
    <span class="token keyword">const</span> imgs <span class="token operator">=</span> <span class="token builtin">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;.tea_main .tea_con .li_img &gt; img&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> item <span class="token operator">=&gt;</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">http://web.xx.com/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span><span class="token function">encodeURI</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&#39;src&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span>
    <span class="token builtin">Promise</span><span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span>imgs<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> <span class="token function">download</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token string">&#39;dist&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;files downloaded!&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>NewsListSpider\u7C7B\uFF1A</p><div class="language-ts ext-ts code-wrapper"><div class="cbt-traffic_light"><span></span><span></span><span></span></div><span class="copy"></span><div class="code-inner"><pre class="language-ts line-numbers-mode"><code class="language-ts"><span class="token keyword">import</span> Spider <span class="token keyword">from</span> <span class="token string">&#39;./Spider&#39;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">NewsListSpider</span> <span class="token keyword">extends</span> <span class="token class-name">Spider</span> <span class="token punctuation">{</span>
  <span class="token function">onCatchHTML</span><span class="token punctuation">(</span>result<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>\u6D4B\u8BD5\u7C7B\uFF1A</p><div class="language-ts ext-ts code-wrapper"><div class="cbt-traffic_light"><span></span><span></span><span></span></div><span class="copy"></span><div class="code-inner"><pre class="language-ts line-numbers-mode"><code class="language-ts"><span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token class-name">Spider</span> <span class="token keyword">from</span> <span class="token string">&#39;./Spider&#39;</span>
<span class="token keyword">import</span> PhotoListSpider <span class="token keyword">from</span> <span class="token string">&#39;./PhotoListSpider&#39;</span>
<span class="token keyword">import</span> NewsListSpider <span class="token keyword">from</span> <span class="token string">&#39;./NewsListSpider&#39;</span>

<span class="token keyword">const</span> spider1<span class="token operator">:</span> Spider <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PhotoListSpider</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  url<span class="token operator">:</span> <span class="token string">&#39;http://web.xx.com/teacher.html&#39;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> spider2<span class="token operator">:</span> Spider <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NewsListSpider</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  url<span class="token operator">:</span> <span class="token string">&#39;http://www.xx.cn/news/json/f1f5ccee-1158-49a6-b7c4-f0bf40d5161a.json&#39;</span><span class="token punctuation">,</span>
  method<span class="token operator">:</span> <span class="token string">&#39;post&#39;</span><span class="token punctuation">,</span>
  headers<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&#39;Host&#39;</span><span class="token operator">:</span> <span class="token string">&#39;www.xx.cn&#39;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&#39;Connection&#39;</span><span class="token operator">:</span> <span class="token string">&#39;keep-alive&#39;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&#39;Content-Length&#39;</span><span class="token operator">:</span> <span class="token string">&#39;0&#39;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&#39;Accept&#39;</span><span class="token operator">:</span> <span class="token string">&#39;*/*&#39;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&#39;Origin&#39;</span><span class="token operator">:</span> <span class="token string">&#39;http://www.xx.cn&#39;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&#39;X-Requested-With&#39;</span><span class="token operator">:</span> <span class="token string">&#39;XMLHttpRequest&#39;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&#39;User-Agent&#39;</span><span class="token operator">:</span> <span class="token string">&#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.100 Safari/537.36&#39;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&#39;DNT&#39;</span><span class="token operator">:</span> <span class="token string">&#39;1&#39;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&#39;Referer&#39;</span><span class="token operator">:</span> <span class="token string">&#39;http://www.xx.cn/newsvideo/newslist.html&#39;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&#39;Accept-Encoding&#39;</span><span class="token operator">:</span> <span class="token string">&#39;gzip, deflate&#39;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&#39;Accept-Language&#39;</span><span class="token operator">:</span> <span class="token string">&#39;zh-CN,zh;q=0.9,en;q=0.8&#39;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&#39;Cookie&#39;</span><span class="token operator">:</span> <span class="token string">&#39;UM_distinctid=16b8a0c1ea534c-0c311b256ffee7-e343166-240000-16b8a0c1ea689c; bad_idb2f10070-624e-11e8-917f-9fb8db4dc43c=8e1dcca1-9692-11e9-97fb-e5908bcaecf8; parent_qimo_sid_b2f10070-624e-11e8-917f-9fb8db4dc43c=921b3900-9692-11e9-9a47-855e632e21e7; CNZZDATA1277769855=1043056636-1562825067-null%7C1562825067; cid_litiancheng_xx.cn=TUd3emFUWjBNV2syWVRCdU5XTTRhREZs; PHPSESSID=j3ppafq1dgh2jfg6roc8eeljg2; CNZZDATA4617777=cnzz_eid%3D926291424-1561388898-http%253A%252F%252Fmail.xx.cn%252F%26ntime%3D1563262791; Hm_lvt_0cb375a2e834821b74efffa6c71ee607=1561389179,1563266246; qimo_seosource_22bdcd10-6250-11e8-917f-9fb8db4dc43c=%E7%AB%99%E5%86%85; qimo_seokeywords_22bdcd10-6250-11e8-917f-9fb8db4dc43c=; href=http%3A%2F%2Fwww.xx.cn%2F; bad_id22bdcd10-6250-11e8-917f-9fb8db4dc43c=f2f41b71-a7a4-11e9-93cc-9b702389a8cb; nice_id22bdcd10-6250-11e8-917f-9fb8db4dc43c=f2f41b72-a7a4-11e9-93cc-9b702389a8cb; openChat22bdcd10-6250-11e8-917f-9fb8db4dc43c=true; parent_qimo_sid_22bdcd10-6250-11e8-917f-9fb8db4dc43c=fc61e520-a7a4-11e9-94a8-01dabdc2ed41; qimo_seosource_b2f10070-624e-11e8-917f-9fb8db4dc43c=%E7%AB%99%E5%86%85; qimo_seokeywords_b2f10070-624e-11e8-917f-9fb8db4dc43c=; accessId=b2f10070-624e-11e8-917f-9fb8db4dc43c; pageViewNum=2; nice_idb2f10070-624e-11e8-917f-9fb8db4dc43c=20d2a1d1-a7a8-11e9-bc20-e71d1b8e4bb6; openChatb2f10070-624e-11e8-917f-9fb8db4dc43c=true; Hm_lpvt_0cb375a2e834821b74efffa6c71ee607=1563267937&#39;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>\u5C01\u88C5\u540E\uFF0C\u5982\u679C\u9700\u8981\u5199\u65B0\u7684\u722C\u866B\uFF0C\u5219\u53EF\u4EE5\u76F4\u63A5\u7EE7\u627FSpider\u7C7B\u540E\uFF0C\u5728\u6D4B\u8BD5\u7C7B\u4E2D\u8FDB\u884C\u6D4B\u8BD5\u5373\u53EF\uFF0C\u4EC5\u9700\u5B9E\u73B0\u5177\u4F53\u7684\u722C\u866B\u7C7BonCatchHTML\u65B9\u6CD5\uFF0C\u6D4B\u8BD5\u65F6\u4F20\u5165url\u548Cheaders\u5373\u53EF\u3002</p><p>\u800C\u4E14\u5168\u90E8\u722C\u866B\u7684\u7236\u7C7B\u5747\u4E3ASpider\uFF0C\u540E\u671F\u7BA1\u7406\u8D77\u6765\u4E5F\u975E\u5E38\u65B9\u4FBF\uFF01</p><h1 id="%E7%88%AC%E8%99%AB%E9%AB%98%E7%BA%A7" tabindex="-1"><span class="prefix"></span><span class="content">\u722C\u866B\u9AD8\u7EA7</span><span class="suffix"></span></h1><p>\u76EE\u6807\uFF1A</p><ul><li>\u4F7F\u7528Selenium\u5E93\u722C\u53D6\u524D\u7AEF\u6E32\u67D3\u7684\u7F51\u9875</li><li>\u53CD\u53CD\u722C\u866B\u6280\u672F</li></ul><h2 id="selenium%E7%AE%80%E4%BB%8B" tabindex="-1"><span class="prefix"></span><span class="content">Selenium\u7B80\u4ECB</span><span class="suffix"></span></h2><p>\u5B98\u65B9\u539F\u6587\u4ECB\u7ECD\uFF1A</p><blockquote><p><em>Selenium automates browsers</em>. That\u2019s it! What you do with that power is entirely up to you. Primarily, it is for automating web applications for testing purposes, but is certainly not limited to just that. Boring web-based administration tasks can (and should!) be automated as well.</p><p>Selenium has the support of some of the largest browser vendors who have taken (or are taking) steps to make Selenium a native part of their browser. It is also the core technology in countless other browser automation tools, APIs and frameworks.</p></blockquote><p>\u767E\u5EA6\u767E\u79D1\u4ECB\u7ECD\uFF1A</p><blockquote><p>Selenium [1] \u662F\u4E00\u4E2A\u7528\u4E8EWeb\u5E94\u7528\u7A0B\u5E8F\u6D4B\u8BD5\u7684\u5DE5\u5177\u3002Selenium\u6D4B\u8BD5\u76F4\u63A5\u8FD0\u884C\u5728\u6D4F\u89C8\u5668\u4E2D\uFF0C\u5C31\u50CF\u771F\u6B63\u7684\u7528\u6237\u5728\u64CD\u4F5C\u4E00\u6837\u3002\u652F\u6301\u7684\u6D4F\u89C8\u5668\u5305\u62ECIE\uFF087, 8, 9, 10, 11\uFF09\uFF0C[Mozilla Firefox](<a href="https://baike.baidu.com/item/Mozilla" target="_blank" rel="noopener">https://baike.baidu.com/item/Mozilla</a> Firefox/3504923)\uFF0CSafari\uFF0CGoogle Chrome\uFF0COpera\u7B49\u3002\u8FD9\u4E2A\u5DE5\u5177\u7684\u4E3B\u8981\u529F\u80FD\u5305\u62EC\uFF1A\u6D4B\u8BD5\u4E0E\u6D4F\u89C8\u5668\u7684\u517C\u5BB9\u6027\u2014\u2014\u6D4B\u8BD5\u4F60\u7684\u5E94\u7528\u7A0B\u5E8F\u770B\u662F\u5426\u80FD\u591F\u5F88\u597D\u5F97\u5DE5\u4F5C\u5728\u4E0D\u540C\u6D4F\u89C8\u5668\u548C\u64CD\u4F5C\u7CFB\u7EDF\u4E4B\u4E0A\u3002\u6D4B\u8BD5\u7CFB\u7EDF\u529F\u80FD\u2014\u2014\u521B\u5EFA\u56DE\u5F52\u6D4B\u8BD5\u68C0\u9A8C\u8F6F\u4EF6\u529F\u80FD\u548C\u7528\u6237\u9700\u6C42\u3002\u652F\u6301\u81EA\u52A8\u5F55\u5236\u52A8\u4F5C\u548C\u81EA\u52A8\u751F\u6210 .Net\u3001Java\u3001Perl\u7B49\u4E0D\u540C\u8BED\u8A00\u7684\u6D4B\u8BD5\u811A\u672C\u3002</p></blockquote><p>\u7B80\u5355\u603B\u7ED3\uFF1A</p><p>Selenium\u662F\u4E00\u4E2AWeb\u5E94\u7528\u7684\u81EA\u52A8\u5316\u6D4B\u8BD5\u6846\u67B6\uFF0C\u53EF\u4EE5\u521B\u5EFA\u56DE\u5F52\u6D4B\u8BD5\u6765\u68C0\u9A8C\u8F6F\u4EF6\u529F\u80FD\u548C\u7528\u6237\u9700\u6C42\uFF0C\u901A\u8FC7\u6846\u67B6\u53EF\u4EE5\u7F16\u5199\u4EE3\u7801\u6765\u542F\u52A8\u6D4F\u89C8\u5668\u8FDB\u884C\u81EA\u52A8\u5316\u6D4B\u8BD5\uFF0C\u6362\u8A00\u4E4B\uFF0C\u7528\u4E8E\u505A\u722C\u866B\u5C31\u53EF\u4EE5\u4F7F\u7528\u4EE3\u7801\u542F\u52A8\u6D4F\u89C8\u5668\uFF0C\u8BA9\u771F\u6B63\u7684\u6D4F\u89C8\u5668\u53BB\u6253\u5F00\u7F51\u9875\uFF0C\u7136\u540E\u53BB\u7F51\u9875\u4E2D\u83B7\u53D6\u60F3\u8981\u7684\u4FE1\u606F\uFF01\u4ECE\u800C\u5B9E\u73B0\u771F\u6B63\u610F\u4E49\u4E0A\u65E0\u60E7\u53CD\u722C\u866B\u624B\u6BB5\uFF01</p><h2 id="selenium%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8" tabindex="-1"><span class="prefix"></span><span class="content">Selenium\u7684\u57FA\u672C\u4F7F\u7528</span><span class="suffix"></span></h2><ol><li><p>\u6839\u636E\u5E73\u53F0\u4E0B\u8F7D\u9700\u8981\u7684webdriver</p></li><li><p>\u9879\u76EE\u4E2D\u5B89\u88C5selenium-webdriver\u5305</p></li><li><p>\u6839\u636E\u5B98\u65B9\u6587\u6863\u5199\u4E00\u4E2A\u5C0Fdemo</p></li></ol><h3 id="%E6%A0%B9%E6%8D%AE%E5%B9%B3%E5%8F%B0%E9%80%89%E6%8B%A9webdriver" tabindex="-1"><span class="prefix"></span><span class="content">\u6839\u636E\u5E73\u53F0\u9009\u62E9webdriver</span><span class="suffix"></span></h3><table><thead><tr><th style="text-align:left;">\u6D4F\u89C8\u5668</th><th style="text-align:left;">webdriver</th></tr></thead><tbody><tr><td style="text-align:left;">Chrome</td><td style="text-align:left;"><a href="http://chromedriver.storage.googleapis.com/index.html" target="_blank" rel="noopener">chromedriver(.exe)</a></td></tr><tr><td style="text-align:left;">Internet Explorer</td><td style="text-align:left;"><a href="http://selenium-release.storage.googleapis.com/index.html" target="_blank" rel="noopener">IEDriverServer.exe</a></td></tr><tr><td style="text-align:left;">Edge</td><td style="text-align:left;"><a href="http://go.microsoft.com/fwlink/?LinkId=619687" target="_blank" rel="noopener">MicrosoftWebDriver.msi</a></td></tr><tr><td style="text-align:left;">Firefox</td><td style="text-align:left;"><a href="https://github.com/mozilla/geckodriver/releases/" target="_blank" rel="noopener">geckodriver(.exe)</a></td></tr><tr><td style="text-align:left;">Safari</td><td style="text-align:left;"><a href="https://developer.apple.com/library/prerelease/content/releasenotes/General/WhatsNewInSafari/Articles/Safari_10_0.html#//apple_ref/doc/uid/TP40014305-CH11-DontLinkElementID_28" target="_blank" rel="noopener">safaridriver</a></td></tr></tbody></table><p>\u9009\u62E9\u7248\u672C\u548C\u5E73\u53F0\uFF1A</p><figure><img src="https://gitee.com/artiely/Figure-bed/raw/master/images/20200314165113.png" alt="1563344131390"></figure><p>\u4E0B\u8F7D\u540E\u653E\u5165\u9879\u76EE\u6839\u76EE\u5F55</p><h3 id="%E5%AE%89%E8%A3%85selenium-webdriver%E7%9A%84%E5%8C%85" tabindex="-1"><span class="prefix"></span><span class="content">\u5B89\u88C5selenium-webdriver\u7684\u5305</span><span class="suffix"></span></h3><p><code class="">npm i selenium-webdriver</code></p><h3 id="%E8%87%AA%E5%8A%A8%E6%89%93%E5%BC%80%E7%99%BE%E5%BA%A6%E6%90%9C%E7%B4%A2%E2%80%9C%E5%89%8D%E7%AB%AF%E7%A8%8B%E5%BA%8F%E5%91%98%E2%80%9C" tabindex="-1"><span class="prefix"></span><span class="content">\u81EA\u52A8\u6253\u5F00\u767E\u5EA6\u641C\u7D22\u201C\u524D\u7AEF\u7A0B\u5E8F\u5458\u201C</span><span class="suffix"></span></h3><div class="language-js ext-js code-wrapper"><div class="cbt-traffic_light"><span></span><span></span><span></span></div><span class="copy"></span><div class="code-inner"><pre class="language-js line-numbers-mode"><code class="language-js"><span class="token keyword">const</span> <span class="token punctuation">{</span> Builder<span class="token punctuation">,</span> By<span class="token punctuation">,</span> Key<span class="token punctuation">,</span> until <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;selenium-webdriver&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">example</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> driver <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forBrowser</span><span class="token punctuation">(</span><span class="token string">&#39;chrome&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token comment">// try {</span>
  <span class="token keyword">await</span> driver<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;https://www.baidu.com&#39;</span><span class="token punctuation">)</span>
  <span class="token keyword">await</span> driver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">&#39;kw&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sendKeys</span><span class="token punctuation">(</span><span class="token string">&#39;\u524D\u7AEF\u7A0B\u5E8F\u5458&#39;</span><span class="token punctuation">,</span> Key<span class="token punctuation">.</span><span class="token constant">ENTER</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">await</span> driver<span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span>until<span class="token punctuation">.</span><span class="token function">titleIs</span><span class="token punctuation">(</span><span class="token string">&#39;\u524D\u7AEF\u7A0B\u5E8F\u5458_\u767E\u5EA6\u641C\u7D22&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token comment">// } finally {</span>
  <span class="token comment">//   await driver.quit();</span>
  <span class="token comment">// }</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="%E4%BD%BF%E7%94%A8selenium%E5%AE%9E%E7%8E%B0%E7%88%AC%E8%99%AB" tabindex="-1"><span class="prefix"></span><span class="content">\u4F7F\u7528Selenium\u5B9E\u73B0\u722C\u866B</span><span class="suffix"></span></h2><p>\u5728\u4F7F\u7528Selenium\u5B9E\u73B0\u722C\u866B\u4E4B\u524D\uFF0C\u9700\u8981\u641E\u6E05\u695A\u4E00\u4E2A\u95EE\u9898\uFF1A</p><ul><li>\u4E3A\u4EC0\u4E48\u8981\u7528Selenium\u6765\u505A\u722C\u866B\uFF1F</li></ul><p>\u4E86\u89E3\u5B8C\u540E\uFF0C\u8FD8\u9700\u8981\u77E5\u9053\uFF0C\u5982\u4F55\u5B9E\u73B0\u722C\u866B\uFF1F</p><ol><li>\u81EA\u52A8\u6253\u5F00\u62C9\u52FE\u7F51\u5E76\u641C\u7D22&quot;\u524D\u7AEF&quot;</li><li>\u83B7\u53D6\u6240\u6709\u5217\u8868\u9879</li><li>\u83B7\u53D6\u5176\u4E2D\u60F3\u8981\u7684\u4FE1\u606F\u6570\u636E</li></ol><h3 id="%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E7%94%A8selenium%E6%9D%A5%E5%81%9A%E7%88%AC%E8%99%AB" tabindex="-1"><span class="prefix"></span><span class="content">\u4E3A\u4EC0\u4E48\u8981\u7528Selenium\u6765\u505A\u722C\u866B</span><span class="suffix"></span></h3><p>\u76EE\u524D\u7684\u5927\u6D41\u91CF\u7F51\u7AD9\uFF0C\u90FD\u4F1A\u6709\u4E9B\u5BF9\u5E94\u7684\u53CD\u722C\u866B\u673A\u5236</p><p>\u4F8B\u5982\u5728\u62C9\u52FE\u7F51\u4E0A\u641C\u7D22\u524D\u7AEF\uFF1A</p><figure><img src="https://gitee.com/artiely/Figure-bed/raw/master/images/20200314165114.png" alt="1563347543424"></figure><p>\u627E\u5230\u5BF9\u5E94\u7684ajax\u8BF7\u6C42\u5730\u5740\uFF0C\u4F7F\u7528postman\u6765\u6D4B\u8BD5\u6570\u636E\uFF1A</p><figure><img src="https://gitee.com/artiely/Figure-bed/raw/master/images/20200314165538.png" alt=""></figure><p>\u524D\u51E0\u6B21\u53EF\u80FD\u4F1A\u83B7\u53D6\u5230\u6570\u636E\uFF0C\u4F46\u591A\u51E0\u6B21\u5219\u4F1A\u51FA\u73B0\u64CD\u4F5C\u9891\u7E41\u8BF7\u7A0D\u540E\u518D\u8BD5\u7684\u95EE\u9898</p><p>\u800C\u901A\u8FC7Selenium\u53EF\u4EE5\u64CD\u4F5C\u6D4F\u89C8\u5668\uFF0C\u6253\u5F00\u67D0\u4E2A\u7F51\u5740\uFF0C\u63A5\u4E0B\u6765\u53EA\u9700\u8981\u5B66\u4E60\u5176API\uFF0C\u5C31\u80FD\u83B7\u53D6\u7F51\u9875\u4E2D\u9700\u8981\u7684\u5185\u5BB9\u4E86\uFF01</p><p>\u53CD\u722C\u866B\u6280\u672F\u53EA\u662F\u9488\u5BF9\u722C\u866B\u7684\uFF0C\u4F8B\u5982\u68C0\u67E5\u8BF7\u6C42\u5934\u662F\u5426\u50CF\u722C\u866B\uFF0C\u68C0\u67E5IP\u5730\u5740\u7684\u8BF7\u6C42\u9891\u7387\uFF08\u5982\u679C\u8FC7\u9AD8\u5219\u5C01\u6740\uFF09\u7B49\u624B\u6BB5</p><p>\u800CSelenium\u6253\u5F00\u7684\u5C31\u662F\u4E00\u4E2A\u81EA\u52A8\u5316\u6D4B\u8BD5\u7684\u6D4F\u89C8\u5668\uFF0C\u548C\u7528\u6237\u6B63\u5E38\u4F7F\u7528\u7684\u6D4F\u89C8\u5668\u5E76\u65E0\u5DEE\u522B\uFF0C\u6240\u4EE5\u518D\u5389\u5BB3\u7684\u53CD\u722C\u866B\u6280\u672F\uFF0C\u4E5F\u65E0\u6CD5\u76F4\u63A5\u628A\u5B83\u5E72\u6389\uFF0C\u9664\u975E\u8FD9\u4E2A\u7F51\u7AD9\u8FDE\u666E\u901A\u7528\u6237\u90FD\u60F3\u653E\u5F03\u6389\uFF0812306\u66FE\u7ECF\u8FEB\u4E8E\u65E0\u5948\u8FD9\u6837\u505A\u8FC7\uFF09</p><h3 id="selenium-api%E5%AD%A6%E4%B9%A0" tabindex="-1"><span class="prefix"></span><span class="content">Selenium API\u5B66\u4E60</span><span class="suffix"></span></h3><p>\u6838\u5FC3\u5BF9\u8C61\uFF1A</p><ul><li><p>Builder</p></li><li><p>WebDriver</p></li><li><p>WebElement</p></li></ul><p>\u8F85\u52A9\u5BF9\u8C61\uFF1A</p><ul><li>By</li><li>Key</li></ul><h4 id="builder" tabindex="-1"><span class="prefix"></span><span class="content">Builder</span><span class="suffix"></span></h4><p>\u7528\u4E8E\u6784\u5EFAWebDriver\u5BF9\u8C61\u7684\u6784\u9020\u5668</p><div class="language-js ext-js code-wrapper"><div class="cbt-traffic_light"><span></span><span></span><span></span></div><span class="copy"></span><div class="code-inner"><pre class="language-js line-numbers-mode"><code class="language-js"><span class="token keyword">const</span> driver <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">webdriver<span class="token punctuation">.</span>Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">forBrowser</span><span class="token punctuation">(</span><span class="token string">&#39;chrome&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>\u5176\u4ED6API\u5982\u4E0B\uFF1A</p><p>\u53EF\u4EE5\u83B7\u53D6\u6216\u8BBE\u7F6E\u4E00\u4E9BOptions</p><figure><img src="https://gitee.com/artiely/Figure-bed/raw/master/images/20200314165116.png" alt="1563349592653"></figure><p>\u5982\u9700\u8BBE\u7F6EChrome\u7684Options\uFF0C\u9700\u8981\u5148\u5BFC\u5165Options\uFF1A</p><div class="language-js ext-js code-wrapper"><div class="cbt-traffic_light"><span></span><span></span><span></span></div><span class="copy"></span><div class="code-inner"><pre class="language-js line-numbers-mode"><code class="language-js"><span class="token keyword">const</span> <span class="token punctuation">{</span> Options <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;selenium-webdriver/chrome&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Options</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
options<span class="token punctuation">.</span><span class="token function">addArguments</span><span class="token punctuation">(</span><span class="token string">&#39;Cookie=user_trace_token=20191130095945-889e634a-a79b-4b61-9ced-996eca44b107; X_HTTP_TOKEN=7470c50044327b9a2af2946eaad67653; _ga=GA1.2.2111156102.1543543186; _gid=GA1.2.1593040181.1543543186; LGUID=20181130095946-9c90e147-f443-11e8-87e4-525400f775ce; sajssdk_2015_cross_new_user=1; JSESSIONID=ABAAABAAAGGABCB5E0E82B87052ECD8CED0421F1D36020D; index_location_city=%E5%85%A8%E5%9B%BD; Hm_lvt_4233e74dff0ae5bd0a3d81c6ccf756e6=1543543186,1543545866; LGSID=20181130104426-da2fc57f-f449-11e8-87ea-525400f775ce; PRE_UTM=; PRE_HOST=www.cnblogs.com; PRE_SITE=https%3A%2F%2Fwww.cnblogs.com%2F; PRE_LAND=https%3A%2F%2Fwww.lagou.com%2Fjobs%2Flist_%25E5%2589%258D%25E7%25AB%25AF%25E5%25BC%2580%25E5%258F%2591%3Fkd%3D%25E5%2589%258D%25E7%25AB%25AF%25E5%25BC%2580%25E5%258F%2591%26spc%3D1%26pl%3D%26gj%3D%26xl%3D%26yx%3D%26gx%3D%26st%3D%26labelWords%3Dlabel%26lc%3D%26workAddress%3D%26city%3D%25E5%2585%25A8%25E5%259B%25BD%26requestId%3D%26pn%3D1; sensorsdata2015jssdkcross=%7B%22distinct_id%22%3A%221676257e1bd8cc-060451fc44d124-9393265-2359296-1676257e1be898%22%2C%22%24device_id%22%3A%221676257e1bd8cc-060451fc44d124-9393265-2359296-1676257e1be898%22%2C%22props%22%3A%7B%22%24latest_traffic_source_type%22%3A%22%E7%9B%B4%E6%8E%A5%E6%B5%81%E9%87%8F%22%2C%22%24latest_referrer%22%3A%22%22%2C%22%24latest_referrer_host%22%3A%22%22%2C%22%24latest_search_keyword%22%3A%22%E6%9C%AA%E5%8F%96%E5%88%B0%E5%80%BC_%E7%9B%B4%E6%8E%A5%E6%89%93%E5%BC%80%22%7D%7D; ab_test_random_num=0; _putrc=30FD5A7177A00E45123F89F2B170EADC; login=true; unick=%E5%A4%A9%E6%88%90; hasDeliver=0; gate_login_token=3e9da07186150513b28b29e8e74f485b86439e1fd26fc4939d32ed2660e8421a; _gat=1; SEARCH_ID=334cf2a080f44f2fb42841f473719162; LGRID=20181130110855-45ea2d22-f44d-11e8-87ee-525400f775ce; Hm_lpvt_4233e74dff0ae5bd0a3d81c6ccf756e6=1543547335; TG-TRACK-CODE=search_code&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">addArguments</span><span class="token punctuation">(</span><span class="token string">&#39;user-agent=&quot;Mozilla/5.0 (iPod; U; CPU iPhone OS 2_1 like Mac OS X; ja-jp) AppleWebKit/525.18.1 (KHTML, like Gecko) Version/3.1.1 Mobile/5F137 Safari/525.20&#39;</span><span class="token punctuation">)</span>
</code></pre></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="webdriver" tabindex="-1"><span class="prefix"></span><span class="content">WebDriver</span><span class="suffix"></span></h4><p>\u901A\u8FC7\u6784\u9020\u5668\u521B\u5EFA\u597DWebDriver\u540E\u5C31\u53EF\u4EE5\u4F7F\u7528API\u67E5\u627E\u7F51\u9875\u5143\u7D20\u548C\u83B7\u53D6\u4FE1\u606F\u4E86\uFF1A</p><ul><li>findElement() \u67E5\u627E\u5143\u7D20</li></ul><figure><img src="https://gitee.com/artiely/Figure-bed/raw/master/images/20200314165117.png" alt="1563349913348"></figure><h4 id="webelement" tabindex="-1"><span class="prefix"></span><span class="content">WebElement</span><span class="suffix"></span></h4><ul><li>getText() \u83B7\u53D6\u6587\u672C\u5185\u5BB9</li><li>sendKeys() \u53D1\u9001\u4E00\u4E9B\u6309\u952E\u6307\u4EE4</li><li>click() \u70B9\u51FB\u8BE5\u5143\u7D20</li></ul><figure><img src="https://gitee.com/artiely/Figure-bed/raw/master/images/20200314165118.png" alt="1563351143458"></figure><h3 id="%E8%87%AA%E5%8A%A8%E6%89%93%E5%BC%80%E6%8B%89%E5%8B%BE%E7%BD%91%E6%90%9C%E7%B4%A2%22%E5%89%8D%E7%AB%AF%22" tabindex="-1"><span class="prefix"></span><span class="content">\u81EA\u52A8\u6253\u5F00\u62C9\u52FE\u7F51\u641C\u7D22&quot;\u524D\u7AEF&quot;</span><span class="suffix"></span></h3><ol><li><p>\u4F7F\u7528driver\u6253\u5F00\u62C9\u52FE\u7F51\u4E3B\u9875</p></li><li><p>\u627E\u5230\u5168\u56FD\u7AD9\u5E76\u70B9\u51FB\u4E00\u4E0B</p></li><li><p>\u8F93\u5165\u201C\u524D\u7AEF\u201D\u5E76\u56DE\u8F66</p></li></ol><div class="language-js ext-js code-wrapper"><div class="cbt-traffic_light"><span></span><span></span><span></span></div><span class="copy"></span><div class="code-inner"><pre class="language-js line-numbers-mode"><code class="language-js"><span class="token keyword">const</span> <span class="token punctuation">{</span> Builder<span class="token punctuation">,</span> By<span class="token punctuation">,</span> Key <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;selenium-webdriver&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> driver <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forBrowser</span><span class="token punctuation">(</span><span class="token string">&#39;chrome&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">await</span> driver<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;https://www.lagou.com/&#39;</span><span class="token punctuation">)</span>
  <span class="token keyword">await</span> driver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">&#39;#changeCityBox .checkTips .tab.focus&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">await</span> driver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">&#39;search_input&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sendKeys</span><span class="token punctuation">(</span><span class="token string">&#39;\u524D\u7AEF&#39;</span><span class="token punctuation">,</span> Key<span class="token punctuation">.</span><span class="token constant">ENTER</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="%E8%8E%B7%E5%8F%96%E9%9C%80%E8%A6%81%E7%9A%84%E6%95%B0%E6%8D%AE" tabindex="-1"><span class="prefix"></span><span class="content">\u83B7\u53D6\u9700\u8981\u7684\u6570\u636E</span><span class="suffix"></span></h3><p>\u4F7F\u7528driver.findElement()\u627E\u5230\u6240\u6709\u6761\u76EE\u9879\uFF0C\u6839\u636E\u9700\u6C42\u5206\u6790\u9875\u9762\u5143\u7D20\uFF0C\u83B7\u53D6\u5176\u6587\u672C\u5185\u5BB9\u5373\u53EF\uFF1A</p><div class="language-js ext-js code-wrapper"><div class="cbt-traffic_light"><span></span><span></span><span></span></div><span class="copy"></span><div class="code-inner"><pre class="language-js line-numbers-mode"><code class="language-js"><span class="token keyword">const</span> <span class="token punctuation">{</span> Builder<span class="token punctuation">,</span> By<span class="token punctuation">,</span> Key <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;selenium-webdriver&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> driver <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forBrowser</span><span class="token punctuation">(</span><span class="token string">&#39;chrome&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">await</span> driver<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;https://www.lagou.com/&#39;</span><span class="token punctuation">)</span>
  <span class="token keyword">await</span> driver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">&#39;#changeCityBox .checkTips .tab.focus&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">await</span> driver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">&#39;search_input&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sendKeys</span><span class="token punctuation">(</span><span class="token string">&#39;\u524D\u7AEF&#39;</span><span class="token punctuation">,</span> Key<span class="token punctuation">.</span><span class="token constant">ENTER</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> items <span class="token operator">=</span> <span class="token keyword">await</span> driver<span class="token punctuation">.</span><span class="token function">findElements</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">className</span><span class="token punctuation">(</span><span class="token string">&#39;con_list_item&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  items<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">async</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u83B7\u53D6\u5C97\u4F4D\u540D\u79F0</span>
    <span class="token keyword">const</span> title <span class="token operator">=</span> <span class="token keyword">await</span> item<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">&#39;.p_top h3&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// \u83B7\u53D6\u5DE5\u4F5C\u5730\u70B9</span>
    <span class="token keyword">const</span> position <span class="token operator">=</span> <span class="token keyword">await</span> item<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">&#39;.p_top em&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// \u83B7\u53D6\u53D1\u5E03\u65F6\u95F4</span>
    <span class="token keyword">const</span> time <span class="token operator">=</span> <span class="token keyword">await</span> item<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">&#39;.p_top .format-time&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// \u83B7\u53D6\u516C\u53F8\u540D\u79F0</span>
    <span class="token keyword">const</span> companyName <span class="token operator">=</span> <span class="token keyword">await</span> item<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">&#39;.company .company_name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// \u83B7\u53D6\u516C\u53F8\u6240\u5728\u884C\u4E1A</span>
    <span class="token keyword">const</span> industry <span class="token operator">=</span> <span class="token keyword">await</span> item<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">&#39;.company .industry&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// \u83B7\u53D6\u85AA\u8D44\u5F85\u9047</span>
    <span class="token keyword">const</span> money <span class="token operator">=</span> <span class="token keyword">await</span> item<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">&#39;.p_bot .money&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// \u83B7\u53D6\u9700\u6C42\u80CC\u666F</span>
    <span class="token keyword">let</span> background <span class="token operator">=</span> <span class="token keyword">await</span> item<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">&#39;.p_bot .li_b_l&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// \u5904\u7406\u9700\u6C42\u80CC\u666F</span>
    background <span class="token operator">=</span> background<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>money<span class="token punctuation">,</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>title<span class="token punctuation">,</span> position<span class="token punctuation">,</span> time<span class="token punctuation">,</span> companyName<span class="token punctuation">,</span> industry<span class="token punctuation">,</span> money<span class="token punctuation">,</span> background<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><h3 id="%E8%87%AA%E5%8A%A8%E7%BF%BB%E9%A1%B5" tabindex="-1"><span class="prefix"></span><span class="content">\u81EA\u52A8\u7FFB\u9875</span><span class="suffix"></span></h3><p>\u601D\u8DEF\u5982\u4E0B\uFF1A</p><ol><li>\u5B9A\u4E49\u521D\u59CB\u9875\u7801</li><li>\u83B7\u53D6\u6570\u636E\u540E\uFF0C\u83B7\u53D6\u9875\u9762\u4E0A\u7684\u603B\u9875\u7801\uFF0C\u5B9A\u4E49\u6700\u5927\u9875\u7801</li><li>\u5F00\u59CB\u83B7\u53D6\u6570\u636E\u65F6\u6253\u5370\u5F53\u524D\u6B63\u5728\u83B7\u53D6\u7684\u9875\u7801\u6570</li><li>\u83B7\u53D6\u5B8C\u4E00\u9875\u6570\u636E\u540E\uFF0C\u5F53\u524D\u9875\u7801\u81EA\u589E\uFF0C\u7136\u540E\u5224\u65AD\u662F\u5426\u8FBE\u5230\u6700\u5927\u9875\u7801</li><li>\u67E5\u627E\u4E0B\u4E00\u9875\u6309\u94AE\u5E76\u8C03\u7528\u70B9\u51FBapi\uFF0C\u8FDB\u884C\u81EA\u52A8\u7FFB\u9875</li><li>\u7FFB\u9875\u540E\u9012\u5F52\u8C03\u7528\u83B7\u53D6\u6570\u636E\u7684\u51FD\u6570</li></ol><div class="language-js ext-js code-wrapper"><div class="cbt-traffic_light"><span></span><span></span><span></span></div><span class="copy"></span><div class="code-inner"><pre class="language-js line-numbers-mode"><code class="language-js"><span class="token keyword">const</span> <span class="token punctuation">{</span> Builder<span class="token punctuation">,</span> By<span class="token punctuation">,</span> Key <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;selenium-webdriver&#39;</span><span class="token punctuation">)</span>

<span class="token keyword">let</span> currentPageNum <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">let</span> maxPageNum <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">const</span> driver <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forBrowser</span><span class="token punctuation">(</span><span class="token string">&#39;chrome&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> driver<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;https://www.lagou.com/&#39;</span><span class="token punctuation">)</span>
  <span class="token keyword">await</span> driver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">&#39;#changeCityBox .checkTips .tab.focus&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">await</span> driver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">&#39;search_input&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sendKeys</span><span class="token punctuation">(</span><span class="token string">&#39;\u524D\u7AEF&#39;</span><span class="token punctuation">,</span> Key<span class="token punctuation">.</span><span class="token constant">ENTER</span><span class="token punctuation">)</span>
  maxPageNum <span class="token operator">=</span> <span class="token keyword">await</span> driver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">className</span><span class="token punctuation">(</span><span class="token string">&#39;totalNum&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">\u6B63\u5728\u83B7\u53D6\u7B2C</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>currentPageNum<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\u9875\u7684\u6570\u636E, \u5171</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>maxPageNum<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\u9875</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> flag <span class="token operator">=</span> <span class="token boolean">true</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> items <span class="token operator">=</span> <span class="token keyword">await</span> driver<span class="token punctuation">.</span><span class="token function">findElements</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">className</span><span class="token punctuation">(</span><span class="token string">&#39;con_list_item&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">const</span> results <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> items<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> item <span class="token operator">=</span> items<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        <span class="token comment">// \u83B7\u53D6\u5C97\u4F4D\u540D\u79F0</span>
        <span class="token keyword">const</span> title <span class="token operator">=</span> <span class="token keyword">await</span> item<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">&#39;.p_top h3&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment">// \u83B7\u53D6\u5DE5\u4F5C\u5730\u70B9</span>
        <span class="token keyword">const</span> position <span class="token operator">=</span> <span class="token keyword">await</span> item<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">&#39;.p_top em&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment">// \u83B7\u53D6\u53D1\u5E03\u65F6\u95F4</span>
        <span class="token keyword">const</span> time <span class="token operator">=</span> <span class="token keyword">await</span> item<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">&#39;.p_top .format-time&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment">// \u83B7\u53D6\u516C\u53F8\u540D\u79F0</span>
        <span class="token keyword">const</span> companyName <span class="token operator">=</span> <span class="token keyword">await</span> item<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">&#39;.company .company_name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment">// \u83B7\u53D6\u516C\u53F8\u6240\u5728\u884C\u4E1A</span>
        <span class="token keyword">const</span> industry <span class="token operator">=</span> <span class="token keyword">await</span> item<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">&#39;.company .industry&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment">// \u83B7\u53D6\u85AA\u8D44\u5F85\u9047</span>
        <span class="token keyword">const</span> money <span class="token operator">=</span> <span class="token keyword">await</span> item<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">&#39;.p_bot .money&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment">// \u83B7\u53D6\u9700\u6C42\u80CC\u666F</span>
        <span class="token keyword">let</span> background <span class="token operator">=</span> <span class="token keyword">await</span> item<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">&#39;.p_bot .li_b_l&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment">// \u5904\u7406\u9700\u6C42\u80CC\u666F</span>
        background <span class="token operator">=</span> background<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>money<span class="token punctuation">,</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span>
        <span class="token comment">// console.log(id, job, area, money, link, need, companyLink, industry, tags, welfare)</span>
        results<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          title<span class="token punctuation">,</span>
          position<span class="token punctuation">,</span>
          time<span class="token punctuation">,</span>
          companyName<span class="token punctuation">,</span>
          industry<span class="token punctuation">,</span>
          money<span class="token punctuation">,</span>
          background<span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>

      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span>

      currentPageNum<span class="token operator">++</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>currentPageNum <span class="token operator">&lt;=</span> maxPageNum<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">await</span> driver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">className</span><span class="token punctuation">(</span><span class="token string">&#39;pager_next&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">await</span> <span class="token function">getData</span><span class="token punctuation">(</span>driver<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// console.log(e.message)</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> flag <span class="token operator">=</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">finally</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token keyword">break</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br></div></div><h1 id="selenium%E7%9A%84%E5%8F%96%E4%BB%A3puppeteer" tabindex="-1"><span class="prefix"></span><span class="content">Selenium\u7684\u53D6\u4EE3<a href="https://github.com/puppeteer/puppeteer" target="_blank" rel="noopener"><em>puppeteer</em></a></span><span class="suffix"></span></h1><h1 id="%E6%80%BB%E7%BB%93" tabindex="-1"><span class="prefix"></span><span class="content">\u603B\u7ED3</span><span class="suffix"></span></h1><p>\u722C\u866B\u795E\u901A\u5E7F\u5927\uFF0C\u7528\u9014\u975E\u5E38\u5E7F\u6CDB\uFF0C\u4E3B\u8981\u7684\u76EE\u6807\u662F\u4E3A\u4E86\u5B9E\u73B0\u81EA\u52A8\u5316\u7A0B\u5E8F\uFF0C\u89E3\u653E\u7A0B\u5E8F\u5458\u7684\u53CC\u624B</p><p>\u5E2E\u52A9\u7A0B\u5E8F\u5458\u81EA\u52A8\u83B7\u53D6\u4E00\u4E9B\u6570\u636E\uFF0C\u6D4B\u8BD5\u4E00\u4E9B\u8F6F\u4EF6\uFF0C\u751A\u81F3\u81EA\u52A8\u64CD\u4F5C\u6D4F\u89C8\u5668\u505A\u5F88\u591A\u4E8B\u60C5</p><p>\u4E5F\u4E0D\u4E4F\u6709\u4E9B\u4E0D\u6CD5\u5206\u5B50\u62FF\u722C\u866B\u505A\u4E00\u4E9B\u8FDD\u6CD5\u7684\u4E8B\u60C5\uFF0C\u5728\u6B64\u5E0C\u671B\u5927\u5BB6\u5B66\u4F1A\u722C\u866B\u4F7F\u7528\u5728\u6B63\u9053\u4E0A\uFF0C\u83B7\u53D6\u4E00\u4E9B\u6211\u4EEC\u9700\u8981\u7684\u6570\u636E\u6765\u8FDB\u884C\u5206\u6790</p><p>\u540C\u65F6\uFF0C\u5728\u722C\u53D6\u76EE\u6807\u7F51\u7AD9\u4E4B\u524D\uFF0C\u5EFA\u8BAE\u5927\u5BB6\u6D4F\u89C8\u8BE5\u7F51\u7AD9\u7684robots.txt\uFF0C\u6765\u786E\u4FDD\u81EA\u5DF1\u722C\u53D6\u7684\u6570\u636E\u5728\u5BF9\u65B9\u5141\u8BB8\u8303\u56F4\u4E4B\u5185</p><p>\u5185\u5BB9\u6DB5\u76D6\uFF1A</p><ol><li>\u722C\u866B\u7B80\u4ECB</li><li>\u722C\u866B\u7684\u610F\u4E49 <ul><li>\u5404\u884C\u5404\u4E1A\u7684\u722C\u866B</li></ul></li><li>\u4F7F\u7528http\u6A21\u5757\u722C\u53D6\u6570\u636E <ul><li>http\u6A21\u5757\u53D1\u9001\u8BF7\u6C42</li></ul></li><li>\u4F7F\u7528cheerio\u5E93\u8FDB\u884CDOM\u89E3\u6790 <ul><li>\u4E00\u4E2A\u670D\u52A1\u7AEF\u89E3\u6790HTML\u7684\u5E93\uFF0C\u4E0EjQuery API\u8BBE\u8BA1\u76F8\u540C</li></ul></li><li>\u4F7F\u7528download\u5E93\u8FDB\u884C\u6587\u4EF6\u4E0B\u8F7D</li><li>\u4F7F\u7528TypeScript\u9762\u5411\u5BF9\u8C61\u601D\u60F3\u8FDB\u884C\u722C\u866B\u57FA\u7840\u5E93\u7684\u5C01\u88C5</li><li>\u4F7F\u7528Selenium\u5B9E\u73B0\u722C\u866B</li><li>\u4F7F\u7528Selenium\u81EA\u52A8\u7FFB\u9875</li><li>Selenium\u7684\u53D6\u4EE3<a href="https://github.com/puppeteer/puppeteer" target="_blank" rel="noopener"><em>puppeteer</em></a></li></ol><p>\u5B66\u4E60\u4E0D\u662F\u767E\u7C73\u51B2\u523A\uFF0C\u800C\u662F\u4E00\u573A\u9A6C\u62C9\u677E\uFF0C\u73B0\u5728\u6240\u5B66\u53EA\u662F\u8D77\u70B9\uFF0C\u66F4\u591A\u7684\u662F\u9700\u8981\u5927\u5BB6\u627E\u5230\u5B66\u4E60\u65B9\u6CD5\uFF0C\u4E0D\u65AD\u7684\u5B66\u4E60\u63D0\u5347\u81EA\u5DF1\uFF0C\u4E00\u8D77\u52A0\u6CB9\uFF01</p>`,164),c=[o],d={title:"\u7F51\u7EDC\u722C\u866B\u5F00\u53D1",tag:["nodejs","http","cheerio","selenium","puppeteer"],author:"Artiely",date:"2018-10-7",cover:"/2022-05-14-21-54-19.png",base64:"fff",tinyCover:"/cover/2022-05-14-21-54-19.png",coverWidth:564,coverHeight:1222,coverPrimary:"343438",coverSecondary:"cbcbc7",meta:[{property:"og:title",content:"\u7F51\u7EDC\u722C\u866B\u5F00\u53D1"}]},l={__name:"2018-10-7-node-spider",setup(u,{expose:s}){return a({title:"\u7F51\u7EDC\u722C\u866B\u5F00\u53D1",meta:[{property:"og:title",content:"\u7F51\u7EDC\u722C\u866B\u5F00\u53D1"}]}),s({frontmatter:{title:"\u7F51\u7EDC\u722C\u866B\u5F00\u53D1",tag:["nodejs","http","cheerio","selenium","puppeteer"],author:"Artiely",date:"2018-10-7",cover:"/2022-05-14-21-54-19.png",base64:"fff",tinyCover:"/cover/2022-05-14-21-54-19.png",coverWidth:564,coverHeight:1222,coverPrimary:"343438",coverSecondary:"cbcbc7",meta:[{property:"og:title",content:"\u7F51\u7EDC\u722C\u866B\u5F00\u53D1"}]}}),(r,k)=>(p(),t("div",null,c))}};typeof n=="function"&&n(l);export{l as default,d as frontmatter};
